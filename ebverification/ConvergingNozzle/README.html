

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Converging Nozzle Case &mdash; PeleC 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Flow Past a Cylinder" href="../FlowPastCylinder/README.html" />
    <link rel="prev" title="C14. Shock interacting with a ramp" href="../C14/README.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            PeleC
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Equations.html">Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Algorithms.html">Numerical Treatment and Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../GettingStarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../BoundaryConditions.html">Boundary Conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../geometry/EB.html">Geometry treatment in PeleC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../LES.html">LES and Hybrid LES/DNS Support</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../VandV.html">Correctness - Verification and Validation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../verification/verification.html">Verification of PeleC</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../ebverification.html">Verification of EB PeleC</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../C1/README.html">C1. Method of manufactured solutions for EB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../C3/README.html">C3. Zero dimensional ignition with embedded boundaries</a></li>
<li class="toctree-l3"><a class="reference internal" href="../C7/README.html">C7. Sod shock tube in rotated channel with AMR</a></li>
<li class="toctree-l3"><a class="reference internal" href="../C8/README.html">C8. Multi-species shock tube in a rotated channel with AMR</a></li>
<li class="toctree-l3"><a class="reference internal" href="../C9/README.html">C9. Acoustic wave in cylindrical channel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../C10/README.html">C10. Hagen–Poiseuille flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../C12/README.html">C12. Smooth periodic problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../C13/README.html">C13. Supersonic vortex study</a></li>
<li class="toctree-l3"><a class="reference internal" href="../C14/README.html">C14. Shock interacting with a ramp</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Converging Nozzle Case</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#case-description">Case description</a></li>
<li class="toctree-l4"><a class="reference internal" href="#property-comparisons-to-quasi-1d-flow">Property Comparisons to Quasi-1D Flow</a></li>
<li class="toctree-l4"><a class="reference internal" href="#effect-of-boundary-conditions">Effect of Boundary Conditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-study">Running study</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../FlowPastCylinder/README.html">Flow Past a Cylinder</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../validation/validation.html">Validation of PeleC</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../PelePhysics.html">PelePhysics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../BoxlibBits.html">Development Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PeleC</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../VandV.html">Correctness - Verification and Validation</a></li>
          <li class="breadcrumb-item"><a href="../ebverification.html">Verification of EB PeleC</a></li>
      <li class="breadcrumb-item active">Converging Nozzle Case</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/ebverification/ConvergingNozzle/README.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="converging-nozzle-case">
<span id="eb-convergingnozzle"></span><h1>Converging Nozzle Case<a class="headerlink" href="#converging-nozzle-case" title="Link to this heading"></a></h1>
<section id="case-description">
<h2>Case description<a class="headerlink" href="#case-description" title="Link to this heading"></a></h2>
<p>This is a round inviscid converging nozzle case that can be compared against analytical
relationships for quasi-one dimensional isentropic compressible flow. The nozzle is
set up with an inlet Mach number of 0.22, and area ratio of 2, and an
outlet pressure of 1 bar. The case uses the gamma law equation of state with <span class="math notranslate nohighlight">\(\gamma=1.4\)</span>.
Rudimentary sponge zones are added at the inlet and outlet to absorb spurious reflected waves.</p>
</section>
<section id="property-comparisons-to-quasi-1d-flow">
<h2>Property Comparisons to Quasi-1D Flow<a class="headerlink" href="#property-comparisons-to-quasi-1d-flow" title="Link to this heading"></a></h2>
<p>Here, we compare property profiles extracted from the centerline of the nozzle
to analytical profiles derived from the quasi-1D flow assumption. The relationship</p>
<div class="math notranslate nohighlight">
\[\left( A/A^{*} \right)^2 = \frac{1}{M^2} \left[\frac{2}{\gamma+1} \left(1 + \frac{\gamma-1}{2} M^2 \right) \right]^{\frac{\gamma+1}{\gamma-1}}\]</div>
<p>is used to determine the analytical Mach number, and then this is converted to a pressure ratio using</p>
<div class="math notranslate nohighlight">
\[p_0/p = (1 + \frac{\gamma-1}{2} M^2)^{\frac{\gamma}{\gamma-1}}.\]</div>
<img alt="../../_images/MachNumber.png" src="../../_images/MachNumber.png" />
<img alt="../../_images/Pressure.png" src="../../_images/Pressure.png" />
<p>There is some discrepancy between the 3D simulation and the analytical quasi-1D profiles, especially
near the beginning and end of the converging section of the nozzle, which is to be expected due to
the sharp change in flow direction at these locations for the 3D simulation. The key
result is that the inlet and outlet conditions match the theoretical predictions.</p>
</section>
<section id="effect-of-boundary-conditions">
<h2>Effect of Boundary Conditions<a class="headerlink" href="#effect-of-boundary-conditions" title="Link to this heading"></a></h2>
<p>Here, we compare three potential subsonic inlet/outlet boundary condition settings. The first is the naive
choice where all flow variables are fixed at the inlet and first-order extrapolation is used for all flow
variables at the exit. The second also uses first-order extrapolation at the outlet, but for the inlet
pressure is taken from the interior cells and all other flow variables are fixed. The final strategy
uses this specification at the inlet and at the outlet applies a characteristic-based extrapolation that
allows the exterior pressure to be specified. This outlet specification comes from Whitfield and Janus (<a class="reference external" href="https://arc.aiaa.org/doi/abs/10.2514/6.1984-1552">Three-Dimensional Unsteady Euler Equations Solution Using Flux Vector Splitting. AIAA Paper 84-1552, 1984.</a>) and is described in Ch. 8 of Blazek’s textbook (<a class="reference external" href="https://www.sciencedirect.com/book/9780080445069/computational-fluid-dynamics-principles-and-applications">Computational Fluid Dunamics - Principles and Applications</a>).</p>
<img alt="../../_images/BCCompare.png" src="../../_images/BCCompare.png" />
<p>This figure shows the minimum and maximum pressures in the domain as a function of time for each boundary
condition specification. The first two approaches, which ignore the transfer of information through
characteristics, result in unphysical behavior. In the first, the pressure ratio across the nozzle is incorrect.
In the second, the pressure ratio is correct once the system reaches a steady state, but no boundary condition
fixes the pressure, so the magnitude of inlet and outlet pressure evolve to undesired values. The third set of
boundary conditions leads to the desired behavior, with the outlet pressure fixed at the specified value and
the inlet pressure having the appropriate relationship given the inlet Mach number and area ratio across the
nozzle (Note, in this figure the maximum and minimum pressures in the domain go slightly above and below the inlet and
outlet pressures due to three-dimensional effects. As shown above, the inlet and outlet pressures on
the centerline match the theoretically predicted values).</p>
</section>
<section id="running-study">
<h2>Running study<a class="headerlink" href="#running-study" title="Link to this heading"></a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">mpi_ranks</span><span class="o">=</span><span class="m">36</span>

<span class="k">for</span><span class="w"> </span>i_in<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span>i_out<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">        </span><span class="nv">dirname</span><span class="o">=</span>run_<span class="nv">$i_in$i_out</span>
<span class="w">        </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$dirname</span>
<span class="w">        </span>mkdir<span class="w"> </span><span class="nv">$dirname</span>
<span class="w">        </span>cp<span class="w"> </span>example.inp<span class="w"> </span><span class="nv">$dirname</span>/run.inp
<span class="w">        </span><span class="nb">cd</span><span class="w"> </span><span class="nv">$dirname</span>
<span class="w">        </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/prob.inlet_type = 0/prob.inlet_type = </span><span class="nv">$i_in</span><span class="s2">/g&quot;</span><span class="w"> </span>run.inp
<span class="w">        </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/prob.outlet_type = 0/prob.outlet_type = </span><span class="nv">$i_out</span><span class="s2">/g&quot;</span><span class="w"> </span>run.inp
<span class="w">        </span>srun<span class="w"> </span>-n<span class="w"> </span><span class="si">${</span><span class="nv">mpi_ranks</span><span class="si">}</span><span class="w"> </span>../PeleC3d.gnu.MPI.ex<span class="w"> </span>run.inp
<span class="w">        </span><span class="nb">cd</span><span class="w"> </span>..
<span class="w">    </span><span class="k">done</span>
<span class="k">done</span>

<span class="c1"># change path to AMReX fextract utility executable as appropriate</span>
../../../Submodules/PelePhysics/Submodules/amrex/Tools/Plotfile/fextract.gnu.ex<span class="w"> </span>run_01/plt24000

<span class="c1"># Requires: Python3 Numpy Scipy Pandas Matplotlib</span>
python<span class="w"> </span>plot.py
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../C14/README.html" class="btn btn-neutral float-left" title="C14. Shock interacting with a ramp" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../FlowPastCylinder/README.html" class="btn btn-neutral float-right" title="Flow Past a Cylinder" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright AMReX Copyright (c) 2021, The Regents of the University of California, through Lawrence Berkeley National Laboratory, the Alliance for Sustainable Energy, LLC., through National Renewable Energy Laboratory, National Technology and Engineering Solutions of Sandia, LLC, and UT-Battelle, LLC (subject to receipt of any required approvals from the U.S. Dept. of Energy).  All rights reserved..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>