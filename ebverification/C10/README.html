<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>C10. Hagen–Poiseuille flow &mdash; PeleC 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=2709fde1"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="C12. Smooth periodic problem" href="../C12/README.html" />
    <link rel="prev" title="C9. Acoustic wave in cylindrical channel" href="../C9/README.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            PeleC
          </a>
              <div class="version">
                0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Equations.html">Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Algorithms.html">Numerical Treatment and Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../GettingStarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../BoundaryConditions.html">Boundary Conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../geometry/EB.html">Geometry treatment in PeleC</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../LES.html">LES and Hybrid LES/DNS Support</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../VandV.html">Correctness - Verification and Validation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../verification/verification.html">Verification of PeleC</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../ebverification.html">Verification of EB PeleC</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../C1/README.html">C1. Method of manufactured solutions for EB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../C3/README.html">C3. Zero dimensional ignition with embedded boundaries</a></li>
<li class="toctree-l3"><a class="reference internal" href="../C7/README.html">C7. Sod shock tube in rotated channel with AMR</a></li>
<li class="toctree-l3"><a class="reference internal" href="../C8/README.html">C8. Multi-species shock tube in a rotated channel with AMR</a></li>
<li class="toctree-l3"><a class="reference internal" href="../C9/README.html">C9. Acoustic wave in cylindrical channel</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">C10. Hagen–Poiseuille flow</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#case-description">Case description</a></li>
<li class="toctree-l4"><a class="reference internal" href="#velocity-profiles-at-x-6-cm-channel-center">Velocity profiles at <span class="math notranslate nohighlight">\(x=6\)</span> cm (channel center)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#l-2-error-norm-of-velocity"><span class="math notranslate nohighlight">\(L_2\)</span> error norm of velocity</a></li>
<li class="toctree-l4"><a class="reference internal" href="#time-convergence-of-kinetic-energy">Time convergence of kinetic energy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-study">Running study</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../C12/README.html">C12. Smooth periodic problem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../C13/README.html">C13. Supersonic vortex study</a></li>
<li class="toctree-l3"><a class="reference internal" href="../C14/README.html">C14. Shock interacting with a ramp</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ConvergingNozzle/README.html">Converging Nozzle Case</a></li>
<li class="toctree-l3"><a class="reference internal" href="../FlowPastCylinder/README.html">Flow Past a Cylinder</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../validation/validation.html">Validation of PeleC</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../PelePhysics.html">PelePhysics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../BoxlibBits.html">Development Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PeleC</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../VandV.html">Correctness - Verification and Validation</a></li>
          <li class="breadcrumb-item"><a href="../ebverification.html">Verification of EB PeleC</a></li>
      <li class="breadcrumb-item active">C10. Hagen–Poiseuille flow</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/ebverification/C10/README.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="c10-hagenpoiseuille-flow">
<span id="eb-c10"></span><h1>C10. Hagen–Poiseuille flow<a class="headerlink" href="#c10-hagenpoiseuille-flow" title="Link to this heading"></a></h1>
<section id="case-description">
<h2>Case description<a class="headerlink" href="#case-description" title="Link to this heading"></a></h2>
<p>This is the standard Hagen–Poiseuille flow. The geometry is a
<span class="math notranslate nohighlight">\(x\)</span>-direction aligned circular channel with imposed pressure
boundary conditions at the inflow and the outflow to enforce a driving
pressure gradient <span class="math notranslate nohighlight">\(dp /dx\)</span>. For this case, the Mach number is
set to 0.1, the Reynolds number to 100, and the Prandtl number to
0.71. The background pressure is atmospheric and the background
temperature is 300K. The cylinder radius, <span class="math notranslate nohighlight">\(R\)</span>, is 1cm and the
cylinder length, <span class="math notranslate nohighlight">\(L\)</span>, is 12cm. The simulations are performed for
5 flowthroughs, at which point in time quantities such as kinetic
energy and momentum are converged.</p>
<p>The exact solution at steady state is</p>
<div class="math notranslate nohighlight">
\[u(r) = \frac{G}{4 \mu} (R^2 - r^2)\]</div>
<p>where <span class="math notranslate nohighlight">\(G = -dp/dx\)</span>, and <span class="math notranslate nohighlight">\(\mu\)</span> is the dynamic viscosity.</p>
</section>
<section id="velocity-profiles-at-x-6-cm-channel-center">
<h2>Velocity profiles at <span class="math notranslate nohighlight">\(x=6\)</span> cm (channel center)<a class="headerlink" href="#velocity-profiles-at-x-6-cm-channel-center" title="Link to this heading"></a></h2>
<a class="reference internal image-reference" href="../../_images/u.png"><img alt="../../_images/u.png" src="../../_images/u.png" style="height: 300pt;" /></a>
</section>
<section id="l-2-error-norm-of-velocity">
<h2><span class="math notranslate nohighlight">\(L_2\)</span> error norm of velocity<a class="headerlink" href="#l-2-error-norm-of-velocity" title="Link to this heading"></a></h2>
<p>The <span class="math notranslate nohighlight">\(L_2\)</span> error norm for a quantity <span class="math notranslate nohighlight">\(s\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[\epsilon = \sqrt{ \frac{\int_{-r}^{r} (s^h-s^*)^2 \mathrm{d}r}{2 n_r}}\]</div>
<p>where <span class="math notranslate nohighlight">\(s^h\)</span> is the numerical solution, <span class="math notranslate nohighlight">\(s^*\)</span> is the exact
solution, and <span class="math notranslate nohighlight">\(n_r\)</span> is the number of cells per radius.</p>
<a class="reference internal image-reference" href="../../_images/error.png"><img alt="../../_images/error.png" src="../../_images/error.png" style="height: 300pt;" /></a>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The exact solution centerline velocity is adjusted by 0.7% to
account for compressibility effects. The observance of second order
behavior is attributed to the fact that this is a diffusion
dominated problem and diffusion treatment at EB surfaces is second
order.</p>
</div>
</section>
<section id="time-convergence-of-kinetic-energy">
<h2>Time convergence of kinetic energy<a class="headerlink" href="#time-convergence-of-kinetic-energy" title="Link to this heading"></a></h2>
<a class="reference internal image-reference" href="../../_images/ke_history.png"><img alt="../../_images/ke_history.png" src="../../_images/ke_history.png" style="height: 300pt;" /></a>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This figure shows that the compressible solution reached a steady
state. It is not expected that the total integration of the kinetic
energy in the domain match the incompressible value for integrated
kinetic energy <span class="math notranslate nohighlight">\(K_e\)</span> because of compressibility effects.</p>
</div>
</section>
<section id="running-study">
<h2>Running study<a class="headerlink" href="#running-study" title="Link to this heading"></a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">paren</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
<span class="nv">pelec</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">paren</span><span class="si">}</span><span class="s2">/PeleC3d.gnu.MPI.ex&quot;</span>
<span class="nv">mpi_ranks</span><span class="o">=</span><span class="m">36</span>

<span class="nv">res</span><span class="o">=(</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">16</span><span class="w"> </span><span class="m">32</span><span class="w"> </span><span class="o">)</span>
<span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">res</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="k">do</span>
<span class="w">    </span>rm<span class="w"> </span>-rf<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span>mkdir<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">exit</span>
<span class="w">    </span>cp<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">paren</span><span class="si">}</span><span class="s2">/inputs_3d&quot;</span><span class="w"> </span>.
<span class="w">    </span><span class="nv">ny</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$((</span><span class="nv">i</span><span class="o">*</span><span class="m">4</span><span class="k">))</span><span class="s2">&quot;</span>
<span class="w">    </span><span class="nv">nx</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$((</span><span class="nv">i</span><span class="o">*</span><span class="m">4</span><span class="o">*</span><span class="m">3</span><span class="k">))</span><span class="s2">&quot;</span>
<span class="w">    </span>srun<span class="w"> </span>-n<span class="w"> </span><span class="si">${</span><span class="nv">mpi_ranks</span><span class="si">}</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">pelec</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>inputs_3d<span class="w"> </span>amr.n_cell<span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">nx</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">ny</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">ny</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>out
<span class="w">    </span>ls<span class="w"> </span>-1v<span class="w"> </span>*plt*/Header<span class="w"> </span><span class="p">|</span><span class="w"> </span>tee<span class="w"> </span>movie.visit
<span class="w">    </span><span class="nb">cd</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">paren</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">exit</span>
<span class="k">done</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../C9/README.html" class="btn btn-neutral float-left" title="C9. Acoustic wave in cylindrical channel" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../C12/README.html" class="btn btn-neutral float-right" title="C12. Smooth periodic problem" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright AMReX Copyright (c) 2021, The Regents of the University of California, through Lawrence Berkeley National Laboratory, the Alliance for Sustainable Energy, LLC., through National Renewable Energy Laboratory, National Technology and Engineering Solutions of Sandia, LLC, and UT-Battelle, LLC (subject to receipt of any required approvals from the U.S. Dept. of Energy).  All rights reserved..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>